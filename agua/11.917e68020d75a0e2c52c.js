(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{QH3N:function(t,e,n){"use strict";n.r(e);var c=n("Valr"),i=n("QJY3"),o=n("MnXN"),a=n("DUip"),r=n("JEAp"),b=n("5PQF"),l=function(){function t(){this.id=0,this.code=this.generate_code(10),this.dispatcher_code="00000000",this.start_time=new Date,this.end_time=new Date,this.attended=!1,this.quantity=250,this.user_id=0}return t.prototype.generate_code=function(t){for(var e="",n=0;n<t;n++)e+=Math.floor(9*Math.random()+1).toString();return e},t}(),s=n("teKj"),d=n("TYT/"),u=n("s4wE"),g=n("ic5g");function f(t,e){1&t&&d.Ob(0,"span",36)}function p(t,e){1&t&&(d.Sb(0,"span",37),d.Ec(1,"Atendido"),d.Rb())}function h(t,e){1&t&&(d.Sb(0,"span",38),d.Ec(1,"No Atendido"),d.Rb())}function S(t,e){if(1&t){var n=d.Tb();d.Sb(0,"tr",30),d.ec("click",(function(){d.vc(n);var t=e.$implicit;return d.gc().selectTicket(t)})),d.Sb(1,"td",31),d.Cc(2,f,1,0,"span",32),d.Rb(),d.Sb(3,"td"),d.Ec(4),d.Rb(),d.Sb(5,"td"),d.Ec(6),d.Rb(),d.Sb(7,"td"),d.Ec(8),d.hc(9,"date"),d.Rb(),d.Sb(10,"td"),d.Ec(11),d.hc(12,"date"),d.Rb(),d.Sb(13,"td"),d.Ec(14),d.Rb(),d.Sb(15,"td",33),d.Cc(16,p,2,0,"span",34),d.Cc(17,h,2,0,"span",35),d.Rb(),d.Rb()}if(2&t){var c=e.$implicit,i=d.gc();d.Ab(2),d.mc("ngIf",i.ticketSelected===c),d.Ab(2),d.Fc(c.code),d.Ab(2),d.Fc(c.dispatcher_code),d.Ab(2),d.Fc(d.jc(9,8,c.start_time,"MMM d, y, h:mm:ss a")),d.Ab(3),d.Fc(d.jc(12,11,c.end_time,"MMM d, y, h:mm:ss a")),d.Ab(3),d.Fc(c.quantity),d.Ab(2),d.mc("ngIf",c.attended),d.Ab(1),d.mc("ngIf",!c.attended)}}function m(t,e){1&t&&(d.Sb(0,"button",39),d.Ec(1,"Primera"),d.Rb())}function v(t,e){if(1&t){var n=d.Tb();d.Sb(0,"button",40),d.ec("click",(function(){return d.vc(n),d.gc().goToPage(1)})),d.Ec(1,"Primera"),d.Rb()}}function k(t,e){if(1&t){var n=d.Tb();d.Sb(0,"button",41),d.ec("click",(function(){d.vc(n);var t=d.gc();return t.goToPage(1*t.currentPage-1)})),d.Ec(1),d.Rb()}if(2&t){var c=d.gc();d.Ab(1),d.Fc(1*c.currentPage-1)}}function R(t,e){if(1&t){var n=d.Tb();d.Sb(0,"button",42),d.ec("click",(function(){d.vc(n);var t=d.gc();return t.goToPage(1*t.currentPage+1)})),d.Ec(1),d.Rb()}if(2&t){var c=d.gc();d.Ab(1),d.Fc(1*c.currentPage+1)}}function y(t,e){if(1&t){var n=d.Tb();d.Sb(0,"button",43),d.ec("click",(function(){d.vc(n);var t=d.gc();return t.goToPage(t.lastPage)})),d.Ec(1,"\xdaltima"),d.Rb()}}function P(t,e){1&t&&(d.Sb(0,"button",44),d.Ec(1,"\xdaltima"),d.Rb())}function _(t,e){if(1&t&&(d.Sb(0,"option",70),d.Ec(1),d.Rb()),2&t){var n=e.$implicit;d.nc("value",n.id),d.Ab(1),d.Gc(" ",n.name," ")}}function C(t,e){if(1&t){var n=d.Tb();d.Sb(0,"div",45),d.Sb(1,"h4",46),d.Ec(2,"Datos:"),d.Rb(),d.Sb(3,"button",47),d.ec("click",(function(){return e.$implicit.dismiss("Cross click")})),d.Sb(4,"span"),d.Ec(5,"\xd7"),d.Rb(),d.Rb(),d.Rb(),d.Sb(6,"div",48),d.Sb(7,"div",0),d.Sb(8,"div",2),d.Sb(9,"div",49),d.Sb(10,"label",50),d.Ec(11,"C\xf3digo Ticket"),d.Rb(),d.Sb(12,"div",51),d.Ob(13,"qr-code",52),d.Ob(14,"br"),d.Sb(15,"strong"),d.Ec(16),d.Rb(),d.Rb(),d.Rb(),d.Sb(17,"div",49),d.Sb(18,"label",53),d.Ec(19,"C\xf3digo Despachador"),d.Rb(),d.Sb(20,"div",51),d.Ob(21,"qr-code",52),d.Ob(22,"br"),d.Sb(23,"strong"),d.Ec(24),d.Rb(),d.Rb(),d.Rb(),d.Sb(25,"div",49),d.Sb(26,"label",54),d.Ec(27,"Cantidad de Agua (mL)"),d.Rb(),d.Sb(28,"div",55),d.Sb(29,"input",56),d.ec("ngModelChange",(function(t){return d.vc(n),d.gc().ticketSelected.quantity=t})),d.Rb(),d.Rb(),d.Rb(),d.Sb(30,"div",49),d.Sb(31,"label",57),d.Ec(32,"Tiempo Inicio Vigencia"),d.Rb(),d.Sb(33,"div",55),d.Sb(34,"strong"),d.Ec(35),d.hc(36,"date"),d.Rb(),d.Rb(),d.Rb(),d.Sb(37,"div",49),d.Sb(38,"label",58),d.Ec(39,"Tiempo Fin Vigencia"),d.Rb(),d.Sb(40,"div",55),d.Sb(41,"strong"),d.Ec(42),d.hc(43,"date"),d.Rb(),d.Rb(),d.Rb(),d.Sb(44,"div",49),d.Sb(45,"label",59),d.Ec(46,"Atendido"),d.Rb(),d.Sb(47,"div",55),d.Sb(48,"label",60),d.Sb(49,"input",61),d.ec("ngModelChange",(function(t){return d.vc(n),d.gc().ticketSelected.attended=t})),d.Rb(),d.Ob(50,"span",62),d.Rb(),d.Rb(),d.Rb(),d.Sb(51,"div",49),d.Sb(52,"label",63),d.Ec(53,"Usuario"),d.Rb(),d.Sb(54,"div",55),d.Sb(55,"select",64),d.ec("ngModelChange",(function(t){return d.vc(n),d.gc().ticketSelected.user_id=t})),d.Sb(56,"option",65),d.Ec(57,"Seleccione..."),d.Rb(),d.Cc(58,_,2,2,"option",66),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Sb(59,"div",67),d.Sb(60,"button",68),d.ec("click",(function(){return e.$implicit.close("Guardar click")})),d.Ec(61,"Guardar"),d.Rb(),d.Sb(62,"button",69),d.ec("click",(function(){return e.$implicit.close("Cancelar click")})),d.Ec(63,"Cancelar"),d.Rb(),d.Rb()}if(2&t){var c=d.gc();d.Ab(13),d.mc("value",c.ticketSelected.code),d.Ab(3),d.Fc(c.ticketSelected.code),d.Ab(5),d.mc("value",c.ticketSelected.dispatcher_code),d.Ab(3),d.Fc(c.ticketSelected.dispatcher_code),d.Ab(5),d.mc("ngModel",c.ticketSelected.quantity),d.Ab(6),d.Fc(d.jc(36,11,c.today,"MMM d, y, h:mm:ss a")),d.Ab(7),d.Fc(d.jc(43,14,c.today_plus,"MMM d, y, h:mm:ss a")),d.Ab(7),d.mc("ngModel",c.ticketSelected.attended),d.Ab(6),d.mc("ngModel",c.ticketSelected.user_id),d.Ab(3),d.mc("ngForOf",c.users),d.Ab(2),d.mc("disabled",0==c.ticketSelected.user_id)}}var M=[{path:"",component:function(){function t(t,e,n,c){this.modalService=t,this.toastr=e,this.userDataService=n,this.ticketDataService=c,this.tickets=[],this.ticketSelected=new l,this.currentPage=1,this.lastPage=1,this.showDialog=!1,this.recordsByPage=5,this.users=[],this.today=new Date,this.today_plus=new Date}return t.prototype.ngOnInit=function(){this.goToPage(1),this.getUser(),this.refresh_clock()},t.prototype.refresh_clock=function(){var t=this;this.today=new Date,this.today_plus=new Date,this.today_plus.setMinutes(this.today.getMinutes()+10),setTimeout((function(){t.refresh_clock()}),1e3)},t.prototype.selectTicket=function(t){this.ticketSelected=t},t.prototype.getUser=function(){var t=this;this.users=[],this.userDataService.get().then((function(e){t.users=e})).catch((function(t){return console.log(t)}))},t.prototype.goToPage=function(t){t<1||t>this.lastPage?this.toastr.errorToastr("La p\xe1gina solicitada no existe.","Error"):(this.currentPage=t,this.getTickets())},t.prototype.getTickets=function(){var t=this;this.tickets=[],this.ticketSelected=new l,this.ticketSelected.user_id=0,this.ticketDataService.get_paginate(this.recordsByPage,this.currentPage).then((function(e){t.tickets=e.data,t.lastPage=e.last_page})).catch((function(t){return console.log(t)}))},t.prototype.newTicket=function(t){this.ticketSelected=new l,this.ticketSelected.user_id=0,this.openDialog(t)},t.prototype.editTicket=function(t){void 0!==this.ticketSelected.id?this.openDialog(t):this.toastr.errorToastr("Debe seleccionar un registro.","Error")},t.prototype.deleteTicket=function(){var t=this;void 0!==this.ticketSelected.id?this.ticketDataService.delete(this.ticketSelected.id).then((function(e){t.toastr.successToastr("Registro Borrado satisfactoriamente.","Borrar"),t.getTickets()})).catch((function(t){return console.log(t)})):this.toastr.errorToastr("Debe seleccionar un registro.","Error")},t.prototype.backup=function(){this.ticketDataService.getBackUp().then((function(t){var e=new Blob([JSON.stringify(t)],{type:"text/plain;charset=utf-8"}),n=new Date;Object(r.saveAs)(e,n.toLocaleDateString()+"_Tickets.json")})).catch((function(t){return console.log(t)}))},t.prototype.toCSV=function(){this.ticketDataService.get().then((function(t){var e="id;code;dispatcher_code;start_time;end_time;attended;quantity;user_id\n";t.forEach((function(t){e+=t.id+";"+t.code+";"+t.dispatcher_code+";"+t.start_time+";"+t.end_time+";"+t.attended+";"+t.quantity+";"+t.user_id+"\n"}));var n=new Blob([e],{type:"text/plain;charset=utf-8"}),c=new Date;Object(r.saveAs)(n,c.toLocaleDateString()+"_Tickets.csv")})).catch((function(t){return console.log(t)}))},t.prototype.decodeUploadFile=function(t){var e=this,n=new FileReader;t.target.files&&t.target.files.length>0&&(n.readAsDataURL(t.target.files[0]),n.onload=function(){var t=n.result.toString().split(",")[1],c=JSON.parse(decodeURIComponent(escape(atob(t))));e.ticketDataService.masiveLoad(c).then((function(t){e.goToPage(e.currentPage)})).catch((function(t){return console.log(t)}))})},t.prototype.openDialog=function(t){var e=this;this.modalService.open(t,{centered:!0}).result.then((function(t){"Guardar click"===t&&(void 0===e.ticketSelected.id||0===e.ticketSelected.id?(e.ticketSelected.start_time=new Date(e.today.getFullYear().toString()+"-"+(e.today.getMonth()+1).toString()+"-"+e.today.getDate().toString()+" "+(e.today.getHours()-5).toString()+":"+e.today.getMinutes().toString()+":"+e.today.getSeconds().toString()),e.ticketSelected.end_time=new Date(e.today.getFullYear().toString()+"-"+(e.today.getMonth()+1).toString()+"-"+e.today.getDate().toString()+" "+(e.today.getHours()-5).toString()+":"+(e.today.getMinutes()+10).toString()+":"+e.today.getSeconds().toString()),e.ticketDataService.post(e.ticketSelected).then((function(t){e.toastr.successToastr("Datos guardados satisfactoriamente.","Nuevo"),e.getTickets()})).catch((function(t){return console.log(t)}))):e.ticketDataService.put(e.ticketSelected).then((function(t){e.toastr.successToastr("Registro actualizado satisfactoriamente.","Actualizar"),e.getTickets()})).catch((function(t){return console.log(t)})))}),(function(t){}))},t.\u0275fac=function(e){return new(e||t)(d.Nb(o.e),d.Nb(u.a),d.Nb(s.a),d.Nb(b.a))},t.\u0275cmp=d.Hb({type:t,selectors:[["app-ticket"]],decls:61,vars:11,consts:[[1,"row"],[1,"col-12","text-right"],[1,"col-12"],["role","toolbar",1,"btn-toolbar"],["role","group",1,"btn-group","mr-2"],["type","button","title","Actualizar",1,"btn","btn-primary",3,"click"],[1,"fas","fa-sync"],["type","button","title","Nuevo",1,"btn","btn-success",3,"click"],[1,"fas","fa-file"],["type","button","title","Eliminar",1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash"],["type","button","title","Exportar CSV",1,"btn","btn-dark",3,"click"],[1,"fas","fa-file-csv"],["type","file","accept",".json",1,"form-control",3,"hidden","change"],["uploadInput",""],[1,"table","table-hover","mt-2"],[3,"click",4,"ngFor","ngForOf"],["type","button","class","btn btn-light","title","Primera P\xe1gina","disabled","",4,"ngIf"],["type","button","class","btn btn-light","title","Primera P\xe1gina",3,"click",4,"ngIf"],["type","button","class","btn btn-light","title","P\xe1gina Anterior",3,"click",4,"ngIf"],["type","button","title","P\xe1gina Actual",1,"btn","btn-primary"],["type","button","class","btn btn-light","title","P\xe1gina Siguiente",3,"click",4,"ngIf"],["type","button","class","btn btn-light","title","\xdaltima P\xe1gina",3,"click",4,"ngIf"],["type","button","class","btn btn-light","title","\xdaltima P\xe1gina","disabled","",4,"ngIf"],[1,"input-group"],[1,"input-group-prepend"],["type","button","title","Ir a la P\xe1gina",1,"input-group-text","btn","btn-success",3,"click"],["type","number","placeholder","Ir a la P\xe1gina",1,"form-control",3,"min","max"],["goToPageNumber",""],["content",""],[3,"click"],[1,"text-right"],["class","far fa-hand-point-right",4,"ngIf"],[2,"color","white"],["class","badge bg-success",4,"ngIf"],["class","badge bg-danger",4,"ngIf"],[1,"far","fa-hand-point-right"],[1,"badge","bg-success"],[1,"badge","bg-danger"],["type","button","title","Primera P\xe1gina","disabled","",1,"btn","btn-light"],["type","button","title","Primera P\xe1gina",1,"btn","btn-light",3,"click"],["type","button","title","P\xe1gina Anterior",1,"btn","btn-light",3,"click"],["type","button","title","P\xe1gina Siguiente",1,"btn","btn-light",3,"click"],["type","button","title","\xdaltima P\xe1gina",1,"btn","btn-light",3,"click"],["type","button","title","\xdaltima P\xe1gina","disabled","",1,"btn","btn-light"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"close",3,"click"],[1,"modal-body"],[1,"form-group","row"],["for","code",1,"col-4","col-form-label"],[1,"col-8","text-center"],["size","100","errorCorrectionLevel","L",3,"value"],["for","dispatcher_code",1,"col-4","col-form-label"],["for","quantity",1,"col-4","col-form-label"],[1,"col-8"],["type","number","id","quantity","name","quantity","placeholder","Cantidad de Agua (mL)",1,"form-control",3,"ngModel","ngModelChange"],["for","start_time",1,"col-4","col-form-label"],["for","end_time",1,"col-4","col-form-label"],["for","attended",1,"col-4","col-form-label"],[1,"switch"],["type","checkbox","id","attended","name","attended","disabled","",3,"ngModel","ngModelChange"],[1,"slider","round"],["for","user_id",1,"col-4","col-form-label"],["id","user_id","name","user_id",1,"form-control",3,"ngModel","ngModelChange"],["value","0","selected",""],[3,"value",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-success",3,"disabled","click"],["type","button",1,"btn","btn-outline-danger",3,"click"],[3,"value"]],template:function(t,e){if(1&t){var n=d.Tb();d.Sb(0,"div",0),d.Sb(1,"h1",1),d.Ec(2," Tickets "),d.Rb(),d.Rb(),d.Sb(3,"div",0),d.Sb(4,"div",2),d.Sb(5,"div",3),d.Sb(6,"div",4),d.Sb(7,"button",5),d.ec("click",(function(){return e.goToPage(e.currentPage)})),d.Ob(8,"i",6),d.Rb(),d.Rb(),d.Sb(9,"div",4),d.Sb(10,"button",7),d.ec("click",(function(){d.vc(n);var t=d.uc(60);return e.newTicket(t)})),d.Ob(11,"i",8),d.Rb(),d.Rb(),d.Sb(12,"div",4),d.Sb(13,"button",9),d.ec("click",(function(){return e.deleteTicket()})),d.Ob(14,"i",10),d.Rb(),d.Rb(),d.Sb(15,"div",4),d.Sb(16,"button",11),d.ec("click",(function(){return e.toCSV()})),d.Ob(17,"i",12),d.Rb(),d.Sb(18,"input",13,14),d.ec("change",(function(t){return e.decodeUploadFile(t)})),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Sb(20,"div",0),d.Sb(21,"div",2),d.Sb(22,"table",15),d.Sb(23,"thead"),d.Sb(24,"tr"),d.Sb(25,"th"),d.Ec(26,"Seleccionado"),d.Rb(),d.Sb(27,"th"),d.Ec(28,"C\xf3digo Ticket"),d.Rb(),d.Sb(29,"th"),d.Ec(30,"C\xf3digo Despachador"),d.Rb(),d.Sb(31,"th"),d.Ec(32,"Tiempo Inicio Vigencia"),d.Rb(),d.Sb(33,"th"),d.Ec(34,"Tiempo Fin Vigencia"),d.Rb(),d.Sb(35,"th"),d.Ec(36,"Cantidad de Agua (mL)"),d.Rb(),d.Sb(37,"th"),d.Ec(38,"Atendido"),d.Rb(),d.Rb(),d.Rb(),d.Sb(39,"tbody"),d.Cc(40,S,18,14,"tr",16),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Sb(41,"div",0),d.Sb(42,"div",2),d.Sb(43,"div",3),d.Sb(44,"div",4),d.Cc(45,m,2,0,"button",17),d.Cc(46,v,2,0,"button",18),d.Cc(47,k,2,1,"button",19),d.Sb(48,"button",20),d.Ec(49),d.Rb(),d.Cc(50,R,2,1,"button",21),d.Cc(51,y,2,0,"button",22),d.Cc(52,P,2,0,"button",23),d.Rb(),d.Sb(53,"div",24),d.Sb(54,"div",25),d.Sb(55,"button",26),d.ec("click",(function(){d.vc(n);var t=d.uc(58);return e.goToPage(t.value)})),d.Ec(56,"Ir a"),d.Rb(),d.Rb(),d.Ob(57,"input",27,28),d.Rb(),d.Rb(),d.Rb(),d.Rb(),d.Cc(59,C,64,17,"ng-template",null,29,d.Dc)}2&t&&(d.Ab(18),d.mc("hidden",!0),d.Ab(22),d.mc("ngForOf",e.tickets),d.Ab(5),d.mc("ngIf",1===e.currentPage),d.Ab(1),d.mc("ngIf",1!==e.currentPage),d.Ab(1),d.mc("ngIf",e.currentPage>1),d.Ab(2),d.Fc(e.currentPage),d.Ab(1),d.mc("ngIf",e.currentPage<e.lastPage),d.Ab(1),d.mc("ngIf",e.currentPage!==e.lastPage),d.Ab(1),d.mc("ngIf",e.currentPage===e.lastPage),d.Ab(5),d.nc("min",1),d.nc("max",e.lastPage))},directives:[c.k,c.l,g.a,i.k,i.b,i.f,i.i,i.a,i.l,i.j,i.m],pipes:[c.d],styles:['.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:60px;height:34px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.slider[_ngcontent-%COMP%]{cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc}.slider[_ngcontent-%COMP%], .slider[_ngcontent-%COMP%]:before{position:absolute;transition:.4s}.slider[_ngcontent-%COMP%]:before{content:"";height:26px;width:26px;left:4px;bottom:4px;background-color:#fff}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#218838}input[_ngcontent-%COMP%]:focus + .slider[_ngcontent-%COMP%]{box-shadow:0 0 1px #218838}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translateX(26px)}.slider.round[_ngcontent-%COMP%]{border-radius:34px}.slider.round[_ngcontent-%COMP%]:before{border-radius:50%}']}),t}()}],A=function(){function t(){}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},imports:[[a.e.forChild(M)],a.e]}),t}();n.d(e,"TicketModule",(function(){return E}));var E=function(){function t(){}return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},providers:[o.e,s.a,b.a],imports:[[c.b,A,g.b,i.c]]}),t}()}}]);